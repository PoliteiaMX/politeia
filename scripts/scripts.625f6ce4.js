"use strict";angular.module("politeiaApp",["ui.router","angularUtils.directives.dirDisqus","angulartics","angulartics.google.analytics"]).config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/"),a.state("index",{url:"/",templateUrl:"views/index.html",controller:"IndexCtrl"}).state("appLayout",{"abstract":!0,templateUrl:"views/app-layout.html"}).state("events",{parent:"appLayout",url:"/events",templateUrl:"views/event-index.html",controller:"EventIndexCtrl"}).state("event",{parent:"appLayout",url:"/events/:eventId",templateUrl:"views/event.html",controller:"EventCtrl"}).state("commitment-gallery",{parent:"appLayout",url:"/events/:eventId/commitments/:commitmentIndex/gallery",templateUrl:"views/gallery.html",controller:"GalleryCtrl"}).state("gallery-item",{parent:"appLayout",url:"/events/:eventId/commitments/:commitmentIndex/gallery/:itemId",templateUrl:"views/gallery-item.html",controller:"GalleryItemCtrl"}).state("officials",{parent:"appLayout",url:"/officials",templateUrl:"views/official-index.html",controller:"OfficialIndexCtrl"}).state("official",{parent:"appLayout",url:"/officials/:officialId",templateUrl:"views/official.html",controller:"OfficialCtrl"})}]),$(function(){$("body").tooltip({selector:'[data-toggle="tooltip"]'})}),angular.module("politeiaApp").controller("MainCtrl",["$scope","$state",function(a,b){a.$state=b}]),angular.module("politeiaApp").controller("EventCtrl",["$rootScope","$scope","$stateParams","$http","$location",function(a,b,c,d,e){b.disqus={shortname:"politeiamx",identifier:null,title:null,url:null,ready:!1},d.get("data/events/"+c.eventId+".json").then(function(a){var c,d=[{id:"completed",title:"cumplidos"},{id:"failed",title:"incumplidos"},{id:"unknown",title:"desconocidos"},{id:"pending",title:"pendientes"}],f={image:"fa-picture-o",video:"fa-youtube-play"};b.event=a.data,c=_.countBy(b.event.commitments,"status"),b.event.statusBreakdown=_.map(d,function(a){return a.count=c[a.id]?c[a.id]:0,a}),_.each(b.event.commitments,function(a){a.gallery&&(a.galleryCount=_.countBy(a.gallery,function(a){return f[a.type]}))}),b.disqus.identifier=b.event.id,b.disqus.title=b.event.title,b.disqus.url=e.absUrl(),b.disqus.ready=!0})}]),angular.module("politeiaApp").controller("OfficialCtrl",["$rootScope","$scope","$stateParams","$http",function(a,b,c,d){d.get("data/officials/"+c.officialId+".json").then(function(a){b.official=a.data})}]),angular.module("politeiaApp").filter("nullFilter",function(){return function(a){return null===a?"?":a}}),angular.module("politeiaApp").directive("piechart",function(){return{template:"<div></div>",restrict:"E",link:function(a,b,c){var d,e,f,g,h=150,i=150,j=Math.min(h,i)/2;d=d3.select(b[0]).append("svg").attr("width",h).attr("height",i).append("g").attr("transform","translate("+h/2+","+i/2+")"),e=d3.svg.arc().outerRadius(j-10).innerRadius(0),f=d3.layout.pie().sort(function(a){return a.count}).value(function(a){return a.count}),a.$watch(c.data,function(a,b){a!==b&&(g=d.selectAll(".arc").data(f(a)).enter().append("g").attr("class","arc"),g.append("path").attr("d",e).attr("class",function(a){return a.data.id}))})}}}),angular.module("politeiaApp").controller("OfficialIndexCtrl",["$scope","$http",function(a,b){a.filter={name:""},b.get("data/officials-index.json").then(function(b){a.officials=b.data})}]),angular.module("politeiaApp").controller("EventIndexCtrl",["$scope","$http",function(a,b){a.filter={title:""},b.get("data/events-index.json").then(function(b){a.events=b.data})}]),angular.module("politeiaApp").controller("GalleryCtrl",["$scope","$stateParams","$http",function(a,b,c){c.get("data/events/"+b.eventId+".json").then(function(c){a.event=c.data,a.commitmentIndex=b.commitmentIndex,a.commitment=a.event.commitments[a.commitmentIndex-1],a.galleryItems=a.commitment.gallery})}]),angular.module("politeiaApp").controller("GalleryItemCtrl",["$scope","$stateParams","$http",function(a,b,c){c.get("data/events/"+b.eventId+".json").then(function(c){a.event=c.data,a.commitmentIndex=b.commitmentIndex,a.commitment=a.event.commitments[a.commitmentIndex-1],a.galleryItem=_.findWhere(a.commitment.gallery,{id:b.itemId}),a.source=a.event.sources[a.galleryItem.source]})}]),angular.module("politeiaApp").controller("IndexCtrl",["$scope",function(a){a.sections=[{id:"events",title:"Sucesos",description:"Eventos destacados que vale la pena seguir, especialmente si se realizaron compromisos de parte de un funcionario o dependencia, o si son particularmente controversiales o poco atinados.",cover:{url:"http://i.imgur.com/HWWefLX.jpg",author:"Eneas De Troya",site:"Flickr",sourceUrl:"https://www.flickr.com/photos/eneas/4451588252"}},{id:"officials",title:"Funcionarios",description:"Encuentra información sobre diversos servidores públicos, su carrera profesional y política, controversias en su trayectoria y formas de contactarlos.",cover:{url:"http://i.imgur.com/o51zSJP.jpg",author:"Antony Stanley",site:"Flickr",sourceUrl:"https://www.flickr.com/photos/antonystanley/2105552839"}}]}]);